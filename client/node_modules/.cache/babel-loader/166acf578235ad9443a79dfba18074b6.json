{"ast":null,"code":"var _jsxFileName = \"/Users/morris754/Documents/projects/dashboard/client/src/components/Timeline.js\";\nimport React, { Component } from 'react';\nimport * as d3 from \"d3\";\n\nclass Timeline extends Component {\n  constructor() {\n    super();\n\n    this.callout = (g, value) => {\n      if (!value) return g.style(\"display\", \"none\");\n      g.style(\"display\", null).style(\"pointer-events\", \"none\").style(\"font\", \"10px sans-serif\");\n      const path = g.selectAll(\"path\").data([null]).join(\"path\").attr(\"fill\", \"white\").attr(\"stroke\", \"black\");\n      const text = g.selectAll(\"text\").data([null]).join(\"text\").call(text => text.selectAll(\"tspan\").data((value + \"\").split(/\\n/)).join(\"tspan\").attr(\"x\", 0).attr(\"y\", (d, i) => `${i * 1.1}em`).style(\"font-weight\", (_, i) => i ? null : \"bold\").text(d => d));\n      const {\n        x,\n        y,\n        width: w,\n        height: h\n      } = text.node().getBBox();\n      text.attr(\"transform\", `translate(${-w / 2},${15 - y})`);\n      path.attr(\"d\", `M${-w / 2 - 10},5H-5l5,-5l5,5H${w / 2 + 10}v${h + 20}h-${w + 20}z`);\n    };\n\n    this.state = {};\n    this.drawChart = this.drawChart.bind(this);\n  }\n\n  componentDidMount() {\n    this.drawChart();\n  }\n\n  formateDate(date) {\n    return date.toLocaleString(\"en\", {\n      month: \"short\",\n      day: \"numeric\",\n      year: \"numeric\",\n      timeZone: \"UTC\"\n    });\n  }\n\n  formatValue(value) {\n    return value.toLocaleString(\"en\", {\n      style: \"currency\",\n      currency: \"USD\"\n    });\n  }\n\n  async drawChart() {\n    var data = Object.assign(d3.csv('../data/aapl.csv').map(({\n      date,\n      close\n    }) => ({\n      date,\n      value: close\n    })), {\n      y: \"$ Close\"\n    });\n    var svg = d3.select(\"body\").append(\"svg\").attr(\"width\", 960).attr(\"height\", 300);\n    var margin = {\n      top: 20,\n      right: 30,\n      bottom: 30,\n      left: 40\n    };\n    var width = svg.attr(\"width\") - margin.left - margin.right;\n    var height = svg.attr(\"height\") - margin.bottom - margin.top;\n    var x = d3.scaleUtc().domain(d3.extent(data, d => d.date)).range([margin.left, width - margin.right]);\n    var y = d3.scaleLinear().domain([0, d3.max(data, d => d.value)]).nice().range([height - margin.bottom, margin.top]);\n\n    var xAxis = g => g.attr(\"transform\", `translate(0,${height - margin.bottom})`).call(d3.axisBottom(x).ticks(width / 80).tickSizeOuter(0));\n\n    var yAxis = g => g.attr(\"transform\", `translate(${margin.left},0)`).call(d3.axisLeft(y)).call(g => g.select(\".domain\").remove()).call(g => g.select(\".tick:last-of-type text\").clone().attr(\"x\", 3).attr(\"text-anchor\", \"start\").attr(\"font-weight\", \"bold\").text(data.y));\n\n    var line = d3.line().curve(d3.curveStep).defined(d => !isNaN(d.value)).x(d => x(d.date)).y(d => y(d.value));\n    svg.append(\"g\").call(xAxis);\n    svg.append(\"g\").call(yAxis);\n    svg.append(\"path\").datum(data).attr(\"fill\", \"none\").attr(\"stroke\", \"steelblue\").attr(\"stroke-width\", 1.5).attr(\"stroke-linejoin\", \"round\").attr(\"stroke-linecap\", \"round\").attr(\"d\", line);\n    const tooltip = svg.append(\"g\");\n    svg.on(\"touchmove mousemove\", function () {\n      const {\n        date,\n        value\n      } = bisect(d3.mouse(this)[0]);\n      tooltip.attr(\"transform\", `translate(${x(date)},${y(value)})`).call(this.callout, `${this.formatValue(value)}\n              ${this.formatDate(date)}`);\n    });\n    svg.on(\"touchend mouseleave\", () => tooltip.call(this.callout, null));\n\n    function bisect() {\n      const bisect = d3.bisector(d => d.date).left;\n      return mx => {\n        const date = x.invert(mx);\n        const index = bisect(data, date, 1);\n        const a = data[index - 1];\n        const b = data[index];\n        return b && date - a.date > b.date - date ? b : a;\n      };\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 13\n      }\n    }, this.state.ticker);\n  }\n\n}\n\nexport default Timeline;","map":{"version":3,"sources":["/Users/morris754/Documents/projects/dashboard/client/src/components/Timeline.js"],"names":["React","Component","d3","Timeline","constructor","callout","g","value","style","path","selectAll","data","join","attr","text","call","split","d","i","_","x","y","width","w","height","h","node","getBBox","state","drawChart","bind","componentDidMount","formateDate","date","toLocaleString","month","day","year","timeZone","formatValue","currency","Object","assign","csv","map","close","svg","select","append","margin","top","right","bottom","left","scaleUtc","domain","extent","range","scaleLinear","max","nice","xAxis","axisBottom","ticks","tickSizeOuter","yAxis","axisLeft","remove","clone","line","curve","curveStep","defined","isNaN","datum","tooltip","on","bisect","mouse","formatDate","bisector","mx","invert","index","a","b","render","ticker"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport * as d3 from \"d3\";\n\nclass Timeline extends Component {\n  constructor() {\n    super()\n    this.state = {\n    }\n    this.drawChart = this.drawChart.bind(this)\n  }\n\n  componentDidMount() {\n    this.drawChart()\n  }\n\n  callout = (g, value) => {\n    if (!value) return g.style(\"display\", \"none\");\n  \n    g\n        .style(\"display\", null)\n        .style(\"pointer-events\", \"none\")\n        .style(\"font\", \"10px sans-serif\");\n  \n    const path = g.selectAll(\"path\")\n      .data([null])\n      .join(\"path\")\n        .attr(\"fill\", \"white\")\n        .attr(\"stroke\", \"black\");\n  \n    const text = g.selectAll(\"text\")\n      .data([null])\n      .join(\"text\")\n      .call(text => text\n        .selectAll(\"tspan\")\n        .data((value + \"\").split(/\\n/))\n        .join(\"tspan\")\n          .attr(\"x\", 0)\n          .attr(\"y\", (d, i) => `${i * 1.1}em`)\n          .style(\"font-weight\", (_, i) => i ? null : \"bold\")\n          .text(d => d));\n  \n    const {x, y, width: w, height: h} = text.node().getBBox();\n  \n    text.attr(\"transform\", `translate(${-w / 2},${15 - y})`);\n    path.attr(\"d\", `M${-w / 2 - 10},5H-5l5,-5l5,5H${w / 2 + 10}v${h + 20}h-${w + 20}z`);\n  }\n\n  formateDate (date) {\n    return date.toLocaleString(\"en\", {\n        month: \"short\",\n        day: \"numeric\",\n        year: \"numeric\",\n        timeZone: \"UTC\"\n      });\n  }\n\n    formatValue(value) {\n    return value.toLocaleString(\"en\", {\n        style: \"currency\",\n        currency: \"USD\"\n      });    \n  }\n\n  async drawChart() {\n    var data = Object.assign(d3.csv('../data/aapl.csv').map(({date, close}) => ({date, value: close})), {y: \"$ Close\"})      \n    var svg = d3.select(\"body\").append(\"svg\")\n      .attr(\"width\", 960)\n      .attr(\"height\", 300)\n\n    var margin = ({top: 20, right: 30, bottom: 30, left: 40})\n    var width = svg.attr(\"width\") - margin.left - margin.right;\n    var height = svg.attr(\"height\") - margin.bottom - margin.top;\n\n\n    var x = d3.scaleUtc()\n    .domain(d3.extent(data, d => d.date))\n    .range([margin.left, width - margin.right])\n    \n    var y = d3.scaleLinear()\n    .domain([0, d3.max(data, d => d.value)]).nice()\n    .range([height - margin.bottom, margin.top])\n\n    var xAxis = g => g\n        .attr(\"transform\", `translate(0,${height - margin.bottom})`)\n        .call(d3.axisBottom(x).ticks(width / 80).tickSizeOuter(0))\n\n    var yAxis = g => g\n        .attr(\"transform\", `translate(${margin.left},0)`)\n        .call(d3.axisLeft(y))\n        .call(g => g.select(\".domain\").remove())\n        .call(g => g.select(\".tick:last-of-type text\").clone()\n            .attr(\"x\", 3)\n            .attr(\"text-anchor\", \"start\")\n            .attr(\"font-weight\", \"bold\")\n            .text(data.y))\n\n    var line = d3.line()\n        .curve(d3.curveStep)\n        .defined(d => !isNaN(d.value))\n        .x(d => x(d.date))\n        .y(d => y(d.value))\n\n    svg.append(\"g\")\n    .call(xAxis);\n    \n    svg.append(\"g\")\n        .call(yAxis);\n    \n    svg.append(\"path\")\n        .datum(data)\n        .attr(\"fill\", \"none\")\n        .attr(\"stroke\", \"steelblue\")\n        .attr(\"stroke-width\", 1.5)\n        .attr(\"stroke-linejoin\", \"round\")\n        .attr(\"stroke-linecap\", \"round\")\n        .attr(\"d\", line);\n      \n        const tooltip = svg.append(\"g\");\n      \n        svg.on(\"touchmove mousemove\", function() {\n          const {date, value} = bisect(d3.mouse(this)[0]);\n      \n          tooltip\n              .attr(\"transform\", `translate(${x(date)},${y(value)})`)\n              .call(this.callout, `${this.formatValue(value)}\n              ${this.formatDate(date)}`);\n        });\n      \n        svg.on(\"touchend mouseleave\", () => tooltip.call(this.callout, null));\n    \n    function bisect() {\n        const bisect = d3.bisector(d => d.date).left;\n        return mx => {\n          const date = x.invert(mx);\n          const index = bisect(data, date, 1);\n          const a = data[index - 1];\n          const b = data[index];\n          return b && (date - a.date > b.date - date) ? b : a;\n        };\n      }\n\n  }\n\n\n  render(){\n    return (<div>{this.state.ticker}</div>)\n  }\n}\n\n\nexport default Timeline;"]},"metadata":{},"sourceType":"module"}